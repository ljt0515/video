var VideoCms={"Comment":{"Init":function(){$("body").on("click",".my_comment_submit",function(a){if($("#content").val()===""){layer.msg("请输入评论内容");return false}VideoCms.Comment.Submit()});$("body").on("click",".my_comment_report",function(b){var a=$(this);if($(this).attr("data-id")){VideoTheme.Ajax("/comment/report.html?id="+a.attr("data-id"),"get","json","",function(c){a.addClass("disabled");layer.msg(c.msg)})}});$("body").on("click",".my_comment_reply",function(d){var b=$(this);if(b.attr("data-id")){var f=b.html();$(".comment_reply_form").remove();if(f=="取消回复"){b.html("回复");return false}if(f=="回复"){$(".my_comment_reply").html("回复")}var c=$(".comment_form").prop("outerHTML");var a=$(c);a.addClass("comment_reply_form");a.find('input[name="comment_pid"]').val(b.attr("data-id"));b.parent().after(a);b.html("取消回复")}});$("body").on("click",".comment_ding_link",function(b){var a=$(this);if(a.attr("data-id")){VideoTheme.Ajax("/comment/ding.html?id="+a.attr("data-id")+"&"+"&type="+a.attr("data-type"),"get","json","",function(c){a.addClass("disabled");if(c.code===1){a.find(".ding_num").html(parseInt(a.find(".ding_num").html())+1)}else{layer.msg(c.msg)}})}})},"Show":function(a){VideoTheme.Ajax("/comment/ajax.html?videoId="+$(".video_ui_comment").attr("data-id")+"&page="+a,"get","html","",function(b){$(".video_ui_comment").html(b)},function(){$(".video_ui_comment").html('<p class="text-center"><a href="javascript:void(0)" onclick="VideoCms.Comment.Show('+a+');">评论加载失败，点击我刷新...</a></p>')})},"Submit":function(){MAC.Gbook.Verify=1;VideoTheme.Ajax("/comment/save.html","post","json",$(".comment_form").serialize()+"&videoId="+$(".video_ui_comment").attr("data-id"),function(a){if(a.code===1){layer.msg(a.msg,{anim:5},function(){VideoCms.Comment.Show(1)})}else{if(MAC.Gbook.Verify===1){$(".captcha-img").click()}layer.msg(a.msg)}})}},"Message":{"Init":function(){$("body").on("click",".message_submit",function(a){if($(".message_data").val()===""){layer.msg("请输入留言内容");return false}VideoCms.Message.Submit()});$(".message_submit").bind("keydown",function(b){var c=b||window.event;var a=c.keyCode||c.which||c.charCode;if(a===13){$(".message_submit").click()}})},"Submit":function(){MAC.Gbook.Verify=1;VideoTheme.Ajax("/message/save.html","post","json",$("#myform").serialize(),function(a){if(a.code==1){layer.msg(a.msg,{anim:5},function(){location.reload()})}else{if(MAC.Message.Verify===1){$(".captcha-img").click()}layer.msg(a.msg)}})}},"Score":function(){var a=0;$("ul.rating li").each(function(c){var e=$(this).attr("title");var d=$("ul.rating li");var b=$(this).index();var f=b+1;$(this).click(function(){if(a>0){layer.msg("已经评分,请务重复评分")}else{d.removeClass("active");$("ul.rating li:lt("+f+")").find(".fa").addClass("fa-star").removeClass("fa-star-o");$("#ratewords").html(e);$.getJSON("/video/score.html?id="+$("#rating").attr("data-id")+"&score="+($(this).attr("val")*2),function(g){if(parseInt(g.code)==1){layer.msg(g.msg);a=1}else{a=1;layer.msg(g.msg)}})}}).hover(function(){this.myTitle=this.title;this.title="";$(this).nextAll().find(".fa").addClass("fa-star-o").removeClass("fa-star");$(this).prevAll().find(".fa").addClass("fa-star").removeClass("fa-star-o");$(this).find(".fa").addClass("fa-star").removeClass("fa-star-o");$("#ratewords").html(e)},function(){this.title=this.myTitle;$("ul.rating li:lt("+f+")").removeClass("hover")})})},"Autocomplete":function(){var a=$("#search").width();try{$(".search_wd").autocomplete("/video/suggest.html?mid=1",{resultsClass:"autocomplete-suggestions",width:a,scrollHeight:410,minChars:1,matchSubset:0,cacheLength:10,multiple:false,matchContains:true,autoFill:false,dataType:"json",parse:function(d){if(d.code===1){$(".head-dropdown").hide();var c=[];$.each(d.data,function(e,f){f.url=d.url;c[e]={data:f}});return c}else{return{data:""}}},formatItem:function(e,d,c){return e.keyword},formatResult:function(e,d,c){return e.keyword}}).result(function(c,e,d){$(this).val(e.name);location.href="/video/detail/"+e.id+".html"})}catch(b){}},"Favorite":function(){if($(".favorite").length>0){$("body").on("click","a.favorite",function(b){var a=$(this);if(a.attr("data-id")){$.ajax({url:"/index.php/user/ajax_ulog/?ac=set&mid="+a.attr("data-mid")+"&id="+a.attr("data-id")+"&type="+a.attr("data-type"),cache:false,dataType:"json",success:function(c){layer.msg(c.msg)}})}})}},"User":{"IsLogin":0,"Login":function(){VideoTheme.Layer.Div(".ajax_login");$("body").on("click",".login_form_submit",function(a){$(this).unbind("click");VideoTheme.Ajax("/login.html","post","json",$(".mac_login_form").serialize(),function(b){layer.msg(b.msg);if(b.code===1){layer.msg(b.msg,{anim:5},function(){location.reload()})}else{layer.msg(b.msg)}})})},"Logout":function(){VideoTheme.Ajax("/logout.html","get","json","",function(a){MAC.Pop.Msg(100,20,a.msg,1000);if(a.code===1){location.reload()}})}}};$(function(){VideoCms.Comment.Init();VideoCms.Message.Init();VideoCms.Autocomplete();VideoCms.Favorite()});